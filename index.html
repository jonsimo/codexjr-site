<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Codex Jr Updater</title>

  <!-- Pixel font (Google Fonts) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

  <style>
    html, body { height: 100%; }
    body {
      margin: 0;
      background: #000;
      overflow: hidden;
      color: #fff;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
    }

    /* Fullscreen background image */
    .bg {
      position: fixed;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;      /* fills screen */
      object-position: center;/* keep centered framing */
      z-index: -2;
      image-rendering: auto;
    }

    /* Optional subtle darken for readability */
    .vignette {
      position: fixed;
      inset: 0;
      background: radial-gradient(ellipse at center, rgba(0,0,0,0.0) 30%, rgba(0,0,0,0.55) 100%);
      z-index: -1;
      pointer-events: none;
    }

    /* Button positioning */
    .download {
      position: fixed;
      left: 50%;
      /* Put it just below the sun — tweak this number to taste */
      top: 68%;
      transform: translate(-50%, -50%);

      font-family: "Press Start 2P", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
      font-size: clamp(14px, 2.1vw, 24px);
      line-height: 1;

      padding: 18px 26px;
      border-radius: 14px;
      text-decoration: none;

      /* Same yellow vibe as JR */
      background: #ffd54a;
      color: #1a1400;

      box-shadow: 0 10px 28px rgba(0,0,0,0.45);
      border: 2px solid rgba(0,0,0,0.25);
      cursor: pointer;
      user-select: none;
    }

    .download:hover { filter: brightness(1.03); }
    .download:active { transform: translate(-50%, -50%) translateY(2px); }

    /* If you want *sharper* pixel feel (optional) */
    @media (prefers-reduced-motion: no-preference) {
      .download { transition: filter 120ms ease; }
    }
  </style>
</head>
<body>

  <!-- Background: use the bigger one for large screens -->
  <picture>
    <source srcset="assets/codexjr-hero-2000.webp" media="(min-width: 900px)">
    <img class="bg" src="assets/codexjr-hero-1000.webp" alt="Codex Jr Updater background">
  </picture>
  <div class="vignette"></div>

  <a class="download" id="downloadBtn" href="#">DOWNLOAD</a>

<script>
  // Set these to your updater repo
  const OWNER = "YOUR_GITHUB_OWNER";
  const REPO  = "YOUR_UPDATER_REPO";

  // Filenames of your Release assets (must match exactly)
  const ASSET = {
    mac: "CodexJr-Updater-mac.zip",
    win: "CodexJr-Updater-windows.zip",
    lin: "CodexJr-Updater-linux.zip"
  };

  function detectOS() {
    const ua = navigator.userAgent.toLowerCase();
    if (ua.includes("mac os x") && !ua.includes("iphone") && !ua.includes("ipad")) return "mac";
    if (ua.includes("windows")) return "win";
    if (ua.includes("linux")) return "lin";
    return "unknown";
  }

  async function getLatestReleaseTag() {
    const url = `https://api.github.com/repos/${OWNER}/${REPO}/releases/latest`;
    const r = await fetch(url, { headers: { "Accept": "application/vnd.github+json" }});
    if (!r.ok) throw new Error("latest release lookup failed");
    const j = await r.json();
    return j.tag_name;
  }

  function releaseAssetUrl(tag, filename) {
    return `https://github.com/${OWNER}/${REPO}/releases/download/${encodeURIComponent(tag)}/${encodeURIComponent(filename)}`;
  }

  document.getElementById("downloadBtn").addEventListener("click", async (ev) => {
    ev.preventDefault();

    const os = detectOS();
    if (os === "unknown") {
      alert("Couldn’t detect your OS. Please download from the GitHub Releases page.");
      return;
    }

    try {
      const tag = await getLatestReleaseTag();
      const file = os === "mac" ? ASSET.mac : os === "win" ? ASSET.win : ASSET.lin;
      window.location.href = releaseAssetUrl(tag, file);
    } catch (e) {
      alert("Couldn’t find the latest release on GitHub yet. Publish a GitHub Release with the .zip assets.");
    }
  });
</script>

</body>
</html>
