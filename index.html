<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Codex Jr Updater</title>
  <style>
    body { margin:0; background:#0b0f1a; color:#e9eefc; font-family: system-ui,-apple-system,Segoe UI,Roboto,sans-serif; }
    .wrap { max-width: 1100px; margin: 0 auto; padding: 42px 18px; text-align:center; }
    .hero { position: relative; border-radius: 18px; overflow:hidden; border: 1px solid rgba(255,255,255,.12); background: rgba(255,255,255,.04); }
    .hero img { width:100%; height:auto; display:block; }
    .btn {
      position:absolute; left:50%; bottom:7%; transform:translateX(-50%);
      padding: 14px 20px; border-radius: 14px; font-weight: 900;
      background:#ffd54a; color:#1a1400; text-decoration:none;
      box-shadow: 0 10px 30px rgba(0,0,0,.35);
    }
    .btn:hover { filter: brightness(1.03); }
    .meta { margin-top: 14px; opacity:.8; font-size: 14px; }
    .links { margin-top: 10px; font-size: 14px; opacity:.85; }
    .links a { color:#9bb7ff; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="hero">
      <picture>
        <source srcset="assets/codexjr-hero-2000.webp" media="(min-width: 900px)">
        <img src="assets/codexjr-hero-1000.webp" alt="Codex Jr Updater">
      </picture>
      <a class="btn" id="downloadBtn" href="#">Download</a>
    </div>

    <div class="meta" id="osHint"></div>

    <div class="links">
      Manual:
      <a id="macLink" href="#">macOS</a> ·
      <a id="winLink" href="#">Windows</a> ·
      <a id="linLink" href="#">Linux</a>
    </div>
  </div>

<script>
  const OWNER = "YOUR_GITHUB_OWNER";
  const REPO  = "YOUR_UPDATER_REPO";

  const ASSET = {
    mac: "CodexJr-Updater-mac.zip",
    win: "CodexJr-Updater-windows.zip",
    lin: "CodexJr-Updater-linux.zip"
  };

  function detectOS() {
    const ua = navigator.userAgent.toLowerCase();
    if (ua.includes("mac os x") && !ua.includes("iphone") && !ua.includes("ipad")) return "mac";
    if (ua.includes("windows")) return "win";
    if (ua.includes("linux")) return "lin";
    return "unknown";
  }

  async function getLatestReleaseTag() {
    const url = `https://api.github.com/repos/${OWNER}/${REPO}/releases/latest`;
    const r = await fetch(url, { headers: { "Accept": "application/vnd.github+json" }});
    if (!r.ok) throw new Error("Could not fetch latest release");
    const j = await r.json();
    return j.tag_name;
  }

  function releaseAssetUrl(tag, filename) {
    return `https://github.com/${OWNER}/${REPO}/releases/download/${encodeURIComponent(tag)}/${encodeURIComponent(filename)}`;
  }

  (async () => {
    const os = detectOS();
    const hint = document.getElementById("osHint");
    hint.textContent = os === "unknown"
      ? "Couldn’t detect OS — use manual links below."
      : `Detected: ${os === "mac" ? "macOS" : os === "win" ? "Windows" : "Linux"}`;

    let tag = null;
    try { tag = await getLatestReleaseTag(); }
    catch (e) { hint.textContent += " (Latest release lookup failed.)"; }

    if (tag) {
      macLink.href = releaseAssetUrl(tag, ASSET.mac);
      winLink.href = releaseAssetUrl(tag, ASSET.win);
      linLink.href = releaseAssetUrl(tag, ASSET.lin);
    }

    downloadBtn.addEventListener("click", (ev) => {
      ev.preventDefault();
      if (!tag) return alert("Could not find latest release. Use manual links or check repo settings.");
      if (os === "mac") location.href = releaseAssetUrl(tag, ASSET.mac);
      else if (os === "win") location.href = releaseAssetUrl(tag, ASSET.win);
      else if (os === "lin") location.href = releaseAssetUrl(tag, ASSET.lin);
      else alert("Couldn’t detect OS. Use the manual links below.");
    });
  })();
</script>
</body>
</html>